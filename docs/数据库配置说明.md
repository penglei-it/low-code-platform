# æ•°æ®åº“é…ç½®è¯´æ˜

## å½“å‰çŠ¶æ€

### âœ… æ•°æ®å·²æŒä¹…åŒ–

é¡¹ç›®**å·²ç»å®ç°äº†æ•°æ®æŒä¹…åŒ–**ï¼Œä½¿ç”¨ **SQLite** æ•°æ®åº“ã€‚

- **æ•°æ®åº“æ–‡ä»¶ä½ç½®**ï¼š`backend/prisma/dev.db`
- **æ•°æ®åº“ç±»å‹**ï¼šSQLiteï¼ˆæ–‡ä»¶æ•°æ®åº“ï¼‰
- **ORM**ï¼šPrisma
- **çŠ¶æ€**ï¼šâœ… å·²åˆå§‹åŒ–ï¼Œæ•°æ®ä¼šè‡ªåŠ¨æŒä¹…åŒ–åˆ°æ–‡ä»¶

### å·²ä½¿ç”¨æ•°æ®åº“çš„æ¨¡å—

ä»¥ä¸‹æ¨¡å—å·²ç»ä½¿ç”¨æ•°æ®åº“å­˜å‚¨ï¼š

1. âœ… **é¡¹ç›®ï¼ˆProjectsï¼‰** - `backend/src/routes/projects.ts`
2. âœ… **æ•°æ®æ¨¡å‹ï¼ˆDataModelsï¼‰** - `backend/src/routes/dataModels.ts`
3. âœ… **APIå®šä¹‰ï¼ˆApiDefinitionsï¼‰** - `backend/src/routes/apiDefinitions.ts`
4. âœ… **å·¥ä½œæµï¼ˆWorkflowsï¼‰** - `backend/src/routes/workflows.ts`
5. âœ… **è¡¨å•å®šä¹‰ï¼ˆFormDefinitionsï¼‰** - `backend/src/routes/formDefinitions.ts`

### æ•°æ®åº“æ–‡ä»¶

æ•°æ®åº“æ–‡ä»¶ä½äºï¼š`backend/prisma/dev.db`

- è¿™æ˜¯ä¸€ä¸ªSQLiteæ–‡ä»¶æ•°æ®åº“
- æ‰€æœ‰æ•°æ®éƒ½ä¼šè‡ªåŠ¨ä¿å­˜åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­
- é‡å¯æœåŠ¡å™¨åæ•°æ®ä¸ä¼šä¸¢å¤±
- å¤‡ä»½æ•°æ®åº“åªéœ€å¤åˆ¶è¿™ä¸ªæ–‡ä»¶

## æ•°æ®åº“è¿æ¥é…ç½®

### å½“å‰é…ç½®ï¼ˆSQLite - é»˜è®¤ï¼‰

å½“å‰ä½¿ç”¨SQLiteæ•°æ®åº“ï¼Œé…ç½®åœ¨ `backend/prisma/schema.prisma`ï¼š

```prisma
datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}
```

**è¯´æ˜**ï¼š
- SQLiteæ˜¯æ–‡ä»¶æ•°æ®åº“ï¼Œä¸éœ€è¦å•ç‹¬çš„æ•°æ®åº“æœåŠ¡å™¨
- æ•°æ®å­˜å‚¨åœ¨ `backend/prisma/dev.db` æ–‡ä»¶ä¸­
- é€‚åˆå¼€å‘å’Œå°å‹é¡¹ç›®ä½¿ç”¨
- æ— éœ€é¢å¤–é…ç½®ï¼Œå¼€ç®±å³ç”¨

### åˆ‡æ¢åˆ°å…¶ä»–æ•°æ®åº“ï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦ä½¿ç”¨å…¶ä»–æ•°æ®åº“ï¼ˆå¦‚PostgreSQLã€MySQLï¼‰ï¼Œå¯ä»¥ä¿®æ”¹é…ç½®ï¼š

#### 1. åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶

åœ¨ `backend` ç›®å½•åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
# PostgreSQLç¤ºä¾‹
DATABASE_URL="postgresql://username:password@localhost:5432/lowcode_platform?schema=public"

# MySQLç¤ºä¾‹
DATABASE_URL="mysql://username:password@localhost:3306/lowcode_platform"

# SQLiteï¼ˆå½“å‰é»˜è®¤ï¼Œä¹Ÿå¯é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®ï¼‰
DATABASE_URL="file:./dev.db"
```

#### 2. ä¿®æ”¹ schema.prisma

ä¿®æ”¹ `backend/prisma/schema.prisma` ä¸­çš„ datasourceï¼š

```prisma
datasource db {
  provider = "postgresql"  // æˆ– "mysql"
  url      = env("DATABASE_URL")
}
```

#### 3. å®‰è£…æ•°æ®åº“é©±åŠ¨

```bash
# PostgreSQL
npm install pg

# MySQL
npm install mysql2
```

#### 4. é‡æ–°åˆå§‹åŒ–æ•°æ®åº“

```bash
cd backend
npx prisma migrate dev --name init
```

## æ•°æ®åº“åˆå§‹åŒ–

å¦‚æœæ•°æ®åº“è¿˜æœªåˆå§‹åŒ–ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

### Windows

```bash
cd backend
åˆå§‹åŒ–æ•°æ®åº“.bat
```

### Linux/Mac

```bash
cd backend
bash åˆå§‹åŒ–æ•°æ®åº“.sh
```

### æ‰‹åŠ¨åˆå§‹åŒ–

```bash
cd backend

# 1. å®‰è£…ä¾èµ–ï¼ˆå¦‚æœè¿˜æœªå®‰è£…ï¼‰
npm install

# 2. ç”ŸæˆPrisma Client
npm run db:generate

# 3. åˆ›å»ºæ•°æ®åº“å’Œè¡¨
npm run db:init
```

## æ•°æ®åº“ç®¡ç†

### æŸ¥çœ‹æ•°æ®åº“å†…å®¹

ä½¿ç”¨ Prisma Studioï¼ˆå¯è§†åŒ–å·¥å…·ï¼‰ï¼š

```bash
cd backend
npm run db:studio
```

æµè§ˆå™¨ä¼šè‡ªåŠ¨æ‰“å¼€ `http://localhost:5555`ï¼Œå¯ä»¥åœ¨å›¾å½¢ç•Œé¢ä¸­æŸ¥çœ‹å’Œç¼–è¾‘æ•°æ®ã€‚

### æ•°æ®åº“è¿ç§»

å½“ä¿®æ”¹äº† `schema.prisma` åï¼Œéœ€è¦åˆ›å»ºè¿ç§»ï¼š

```bash
cd backend
npm run db:migrate
```

### å¤‡ä»½æ•°æ®åº“

SQLiteæ•°æ®åº“å¤‡ä»½éå¸¸ç®€å•ï¼Œåªéœ€å¤åˆ¶æ•°æ®åº“æ–‡ä»¶ï¼š

```bash
# Windows
copy backend\prisma\dev.db backend\prisma\dev.db.backup

# Linux/Mac
cp backend/prisma/dev.db backend/prisma/dev.db.backup
```

## éªŒè¯æ•°æ®åº“è¿æ¥

### æ–¹æ³•1ï¼šå¯åŠ¨æœåŠ¡å™¨

å¯åŠ¨åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœçœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯è¯´æ˜è¿æ¥æˆåŠŸï¼š

```
âœ… æ•°æ®åº“è¿æ¥æˆåŠŸ
```

å¦‚æœè¿æ¥å¤±è´¥ï¼Œä¼šæ˜¾ç¤ºï¼š

```
âš ï¸  æ•°æ®åº“è¿æ¥å¤±è´¥ï¼Œè¯·ç¡®ä¿å·²è¿è¡Œ Prisma è¿ç§»
```

### æ–¹æ³•2ï¼šæµ‹è¯•API

```bash
# åˆ›å»ºæµ‹è¯•é¡¹ç›®
curl -X POST http://localhost:3001/api/projects \
  -H "Content-Type: application/json" \
  -d '{"name":"æµ‹è¯•é¡¹ç›®","description":"è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•"}'

# æŸ¥çœ‹é¡¹ç›®åˆ—è¡¨
curl http://localhost:3001/api/projects
```

### æ–¹æ³•3ï¼šä½¿ç”¨Prisma Studio

```bash
cd backend
npm run db:studio
```

## å¸¸è§é—®é¢˜

### Q1: æ•°æ®åº“æ–‡ä»¶åœ¨å“ªé‡Œï¼Ÿ

A: SQLiteæ•°æ®åº“æ–‡ä»¶ä½äº `backend/prisma/dev.db`

### Q2: å¦‚ä½•åˆ‡æ¢æ•°æ®åº“ï¼Ÿ

A: ä¿®æ”¹ `backend/prisma/schema.prisma` ä¸­çš„ datasource é…ç½®ï¼Œå¹¶åˆ›å»ºç›¸åº”çš„ `.env` æ–‡ä»¶ã€‚

### Q3: æ•°æ®ä¼šä¸¢å¤±å—ï¼Ÿ

A: ä¸ä¼šã€‚SQLiteæ˜¯æ–‡ä»¶æ•°æ®åº“ï¼Œæ•°æ®æŒä¹…åŒ–å­˜å‚¨åœ¨ `dev.db` æ–‡ä»¶ä¸­ï¼Œé‡å¯æœåŠ¡å™¨ä¸ä¼šä¸¢å¤±æ•°æ®ã€‚

### Q4: å¦‚ä½•åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼Ÿ

A: å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ PostgreSQL æˆ– MySQLï¼š
1. ä¿®æ”¹ schema.prisma ä½¿ç”¨å¯¹åº”çš„æ•°æ®åº“provider
2. é…ç½® DATABASE_URL ç¯å¢ƒå˜é‡
3. è¿è¡Œæ•°æ®åº“è¿ç§»

### Q5: æ•°æ®åº“è¿ç§»å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

A: 
1. æ£€æŸ¥æ•°æ®åº“è¿æ¥é…ç½®
2. ç¡®ä¿æ•°æ®åº“æœåŠ¡æ­£åœ¨è¿è¡Œï¼ˆå¦‚æœæ˜¯PostgreSQL/MySQLï¼‰
3. æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„æƒé™
4. æŸ¥çœ‹é”™è¯¯æ—¥å¿—è·å–è¯¦ç»†ä¿¡æ¯

## æ€»ç»“

- âœ… **æ•°æ®å·²æŒä¹…åŒ–**ï¼šä½¿ç”¨SQLiteæ–‡ä»¶æ•°æ®åº“
- âœ… **æ— éœ€é¢å¤–é…ç½®**ï¼šSQLiteå¼€ç®±å³ç”¨
- âœ… **æ•°æ®å®‰å…¨**ï¼šæ•°æ®å­˜å‚¨åœ¨æ–‡ä»¶ä¸­ï¼Œé‡å¯ä¸ä¸¢å¤±
- ğŸ”„ **å¯æ‰©å±•**ï¼šæ”¯æŒåˆ‡æ¢åˆ°PostgreSQL/MySQLç­‰æ•°æ®åº“

å½“å‰é…ç½®å·²ç»å¯ä»¥æ»¡è¶³å¼€å‘éœ€æ±‚ã€‚å¦‚æœéœ€è¦æ›´é«˜çš„å¹¶å‘æ€§èƒ½æˆ–éœ€è¦åˆ†å¸ƒå¼éƒ¨ç½²ï¼Œå¯ä»¥åˆ‡æ¢åˆ°PostgreSQLæˆ–MySQLã€‚


