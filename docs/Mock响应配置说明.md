# Mock响应配置说明

## 什么是Mock响应？

Mock响应是模拟的API返回数据，用于在API路径不是完整的HTTP/HTTPS地址时，提供测试数据。当API路径是相对路径（如 `/api/users`）时，系统会使用Mock响应来模拟API返回。

## Mock响应的目的和必要性

### 为什么需要Mock响应？

**Mock响应的核心价值：**

1. **前端开发独立**
   - ✅ 无需等待后端接口完成，前端可以独立开发和测试
   - ✅ 前后端并行开发，大幅提高开发效率
   - ✅ 减少前后端依赖，降低沟通成本

2. **快速迭代**
   - ✅ 可以快速验证前端功能，无需等待后端部署
   - ✅ 提高开发效率，缩短开发周期
   - ✅ 快速验证UI和交互逻辑

3. **数据模拟**
   - ✅ 模拟各种数据场景（成功、失败、边界情况）
   - ✅ 测试异常数据处理
   - ✅ 验证不同数据格式的展示效果

4. **离线开发**
   - ✅ 即使后端服务不可用，也能继续开发
   - ✅ 不依赖网络环境
   - ✅ 本地开发更稳定可靠

5. **测试场景**
   - ✅ 模拟不同响应状态码
   - ✅ 测试错误处理逻辑
   - ✅ 验证UI展示效果

### Mock响应是否必要？

**答案：视情况而定，但强烈建议配置**

**必须配置Mock响应的场景：**
- ✅ API路径是相对路径（如 `/api/users`）
- ✅ 后端接口尚未开发完成
- ✅ 需要离线开发
- ✅ 需要模拟特定数据场景
- ✅ 前端需要独立开发和测试

**可以不配置Mock响应的场景：**
- ✅ API路径是完整URL（如 `https://api.example.com/users`）
- ✅ 后端接口已开发完成且稳定可用
- ✅ 需要测试真实接口响应

**使用规则：**
1. **相对路径 + 有Mock响应** → 使用Mock响应（推荐）
2. **相对路径 + 无Mock响应 + 有环境基础URL** → 发送真实请求
3. **完整URL** → 发送真实请求（忽略Mock响应）

**最佳实践：**
- 建议所有API都配置Mock响应，即使后端已开发完成
- Mock响应可以作为接口文档和测试用例
- 便于前端开发人员理解接口数据结构

## 如何配置Mock响应？

### 方法一：新建API时配置

1. **点击"新建API"按钮**
   - 在API设计器页面，点击右上角的"+ 新建API"按钮

2. **填写基本信息**
   - 名称：例如"查询用户列表"
   - 描述：接口用途描述
   - 方法：选择HTTP方法（GET、POST、PUT、DELETE）
   - 路径：输入API路径，例如 `/api/users` 或 `https://api.example.com/users`

3. **切换到"Mock响应"标签页**
   - 在弹窗中，找到顶部的标签页
   - 点击"Mock响应"标签（第四个标签）

4. **输入JSON格式的Mock数据**
   ```json
   {
     "code": 0,
     "message": "success",
     "data": [
       {
         "id": 1,
         "name": "张三",
         "email": "zhangsan@example.com"
       },
       {
         "id": 2,
         "name": "李四",
         "email": "lisi@example.com"
       }
     ]
   }
   ```

5. **点击"确定"保存**
   - 系统会自动验证JSON格式
   - 如果格式错误，会提示"请输入有效的JSON格式"

### 方法二：编辑已有API

1. **点击"编辑"按钮**
   - 在API列表的操作列，点击要编辑的API的"编辑"按钮

2. **切换到"Mock响应"标签页**
   - 在弹窗中，点击"Mock响应"标签

3. **修改或添加Mock数据**
   - 如果已有Mock数据，可以直接修改
   - 如果没有，输入新的JSON格式数据

4. **点击"确定"保存**

## Mock响应格式要求

### ✅ 正确的格式

1. **必须是有效的JSON格式**
   ```json
   {
     "code": 0,
     "data": []
   }
   ```

2. **支持嵌套对象和数组**
   ```json
   {
     "status": "success",
     "result": {
       "total": 100,
       "items": [
         {"id": 1, "name": "Item 1"},
         {"id": 2, "name": "Item 2"}
       ]
     }
   }
   ```

3. **支持各种数据类型**
   ```json
   {
     "string": "文本",
     "number": 123,
     "boolean": true,
     "null": null,
     "array": [1, 2, 3],
     "object": {"key": "value"}
   }
   ```

### ❌ 错误的格式

1. **不是有效的JSON**
   ```
   { code: 0 }  // 缺少引号
   ```

2. **包含注释**
   ```json
   {
     "code": 0  // 这是注释，JSON不支持
   }
   ```

3. **单引号**
   ```json
   {
     'code': 0  // JSON必须使用双引号
   }
   ```

## 使用场景

### 场景1：本地开发测试

当API路径是相对路径（如 `/api/users`）时：
- 系统会使用Mock响应来模拟API返回
- 点击"发送测试"按钮，会返回Mock数据
- 不会发送真实的HTTP请求

### 场景2：真实API测试

当API路径是完整的HTTP/HTTPS地址（如 `https://api.example.com/users`）时：
- 系统会发送真实的HTTP请求
- 返回真实的API响应
- Mock响应不会使用（但仍可配置作为参考）

## 常见示例

### 示例1：用户列表API

```json
{
  "code": 0,
  "message": "获取成功",
  "data": {
    "total": 2,
    "list": [
      {
        "id": 1,
        "username": "admin",
        "email": "admin@example.com",
        "role": "管理员"
      },
      {
        "id": 2,
        "username": "user",
        "email": "user@example.com",
        "role": "普通用户"
      }
    ]
  }
}
```

### 示例2：错误响应

```json
{
  "code": 400,
  "message": "参数错误",
  "error": {
    "field": "username",
    "reason": "用户名不能为空"
  }
}
```

### 示例3：分页数据

```json
{
  "code": 0,
  "data": {
    "page": 1,
    "pageSize": 10,
    "total": 100,
    "items": [
      {"id": 1, "name": "Item 1"},
      {"id": 2, "name": "Item 2"}
    ]
  }
}
```

## 注意事项

1. **JSON格式验证**
   - 系统会自动验证JSON格式
   - 格式错误时无法保存

2. **警告提示**
   - 如果API未配置Mock响应，在选择该API时会显示黄色警告横幅
   - 测试时会提示"该API未配置Mock响应"

3. **数据持久化**
   - Mock响应数据保存在浏览器的localStorage中
   - 清除浏览器缓存会丢失数据

4. **默认值**
   - 新建API时，系统会自动填充默认的Mock响应：
     ```json
     {
       "code": 0,
       "data": []
     }
     ```
   - 可以修改为实际需要的格式

## 快速配置步骤总结

1. 点击"新建API"或"编辑"
2. 填写基本信息（名称、方法、路径等）
3. 点击"Mock响应"标签页
4. 输入JSON格式的Mock数据
5. 点击"确定"保存

配置完成后，警告横幅会自动消失，测试时可以使用Mock数据。

